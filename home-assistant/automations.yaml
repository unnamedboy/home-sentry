- alias: "Grafana Alert - Window State"
  id: "grafana_ios_push_window_state"
  triggers:
    - trigger: webhook
      webhook_id: "grafana-vHuNhmA9EfyGO2oFYLCsWpGP"
      allowed_methods:
        - POST
      local_only: true
  actions:
    - action: notify.notify
      data:
        title: "ğŸ“Š Grafana ç›‘æ§"
        message: |
          æ›´æ–°æ—¶é—´: {{ now().strftime('%H:%M:%S') }}
          {% if trigger.json.alerts is defined %}
          {% for alert in trigger.json.alerts %}
          ğŸªŸ {{ alert.labels.friendly_name | default('æœªçŸ¥è®¾å¤‡') }}: {{ 'ğŸ”´æœªå…³' if alert.status == 'firing' else 'ğŸŸ¢å·²å…³' }}
          {% endfor %}
          {% else %}
          âš ï¸ æ”¶åˆ°æµ‹è¯•ä¿¡å· (æ— è®¾å¤‡æ•°æ®)
          {% endif %}
        data:
          tag: "grafana_alert"
          push:
            interruption-level: active
          presentation_options:
            - alert
            - badge
            - sound
  mode: single
